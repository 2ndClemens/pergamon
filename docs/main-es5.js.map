{"version":3,"sources":["webpack:///src/app/components/stage/stage.component.html","webpack:///src/app/components/controls/controls.component.scss","webpack:///src/app/components/instanced-object/instanced-object.component.ts","webpack:///src/environments/environment.ts","webpack:///src/app/components/instanced-object/instanced-object.component.html","webpack:///src/app/services/camera-position.service.ts","webpack:///src/app/components/stage/stage.component.ts","webpack:///src/app/services/entity.service.ts","webpack:///src/app/components/controls/controls.component.ts","webpack:///src/app/components/controls/controls.component.html","webpack:///src/app/components/stage/stage.component.scss","webpack:///src/app/app.component.ts","webpack:///src/app/app.component.html","webpack:///src/app/shader/instanced-shader.ts","webpack:///src/app/services/sky.service.ts","webpack:///src/app/app.module.ts","webpack:///src/app/components/Player.js","webpack:///src/app/data/entities.ts","webpack:///src/app/services/control-state.service.ts","webpack:///src/app/components/instanced-object/instanced-object.component.scss","webpack:///src/app/app-routing.module.ts","webpack:///src/app/data/controls.ts","webpack:///src/app/app.component.scss","webpack:///src/main.ts","webpack:///$_lazy_route_resource lazy namespace object"],"names":["InstancedObjectComponent","lights","vertexShader","fragmentShader","init","instanceBuffer","i","ul","instances","offsets","setXYZ","transforms","position","x","y","z","needsUpdate","length","loader","setPath","load","src","gltf","g1","scene","children","geometry","mergeGeometry","mergeBufferGeometries","mirror","rotateY","Math","PI","scale","loadedMaterial","material","Float32Array","setUsage","vector","setAttribute","orientations","count","setFromEuler","rotation","setXYZW","w","texture","map","ambientMap","attributes","uv2","anisotropy","renderer","capabilities","getMaxAnisotropy","uniforms","value","side","transparent","mesh","transform","set","frustumCulled","matrixAutoUpdate","updateMatrix","add","aoMap","flipY","aoMapIntensity","dummy","setMatrixAt","matrix","temp","faces","face","normal","vertexNormals","a","c","faceVertexUvs","verticesNeedUpdate","normalsNeedUpdate","vertexNormalsNeedUpdate","computeBoundingSphere","selector","template","changeDetection","OnPush","environment","production","CameraPositionService","controlStateService","direction","player","deltaTime","state","getControlState","sin","cos","slowdown","forward","backwards","right","left","mouseIsDown","mouseX","providedIn","StageComponent","entityService","skyService","cameraPositionService","createEntities","entities","getEntities","clock","entityManager","time","container","document","getElementById","camera","window","innerWidth","innerHeight","makeSky","setPixelRatio","devicePixelRatio","setSize","appendChild","domElement","stats","dom","loader2","epsilonCoplanarTest","then","navMesh","head","setRenderComponent","sync","animate","console","log","aspect","updateProjectionMatrix","requestAnimationFrame","bind","render","update","delta","getDelta","updateCamera","height","entity","renderComponent","EntityService","n","posX","posZ","posY","k","push","distance","ControlsComponent","ev","preventDefault","controlState","clientX","mouseY","clientY","touches","keyCode","AppComponent","title","SkyService","light","target","hemilight","sky","setScalar","turbidity","rayleigh","mieCoefficient","mieDirectionalG","parameters","inclination","azimuth","theta","phi","sunPosition","copy","AppModule","declarations","imports","providers","bootstrap","startPosition","endPosition","Player","maxSpeed","updateOrientation","currentRegion","clampMovement","distanceToPoint","ENTITIES","ControlStateService","routes","AppRoutingModule","forRoot","relativeLinkResolution","exports","CONTROLS","bootstrapModule","err","error","webpackEmptyAsyncContext","req","Promise","resolve","e","Error","code","keys","module","id"],"mappings":"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","file":"main-es5.js","sourcesContent":["export default \"<div id=\\\"container\\\" (window:resize)=\\\"onWindowResize();\\\" draggable=\\\"false\\\"></div>\\r\\n<pgm-controls draggable=\\\"false\\\"></pgm-controls>\\r\\n<!-- <div  draggable=\\\"false\\\" style=\\\"position: absolute; top: 20px; right: 20px;\\\">{{camera.position.x}}</div> -->\\r\\n\\r\\n<pgm-instanced-object *ngFor=\\\"let entity of entities\\\" [scene]=\\\"scene\\\" [renderer]=\\\"renderer\\\" [src]=\\\"entity.src\\\" [transform]=\\\"entity.transform\\\"\\r\\n  [transforms]=\\\"entity.transforms\\\" [mirror]=\\\"entity.mirror\\\">\\r\\n</pgm-instanced-object>\";","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJjb250cm9scy5jb21wb25lbnQuc2NzcyJ9 */\";","import { Component, OnInit, Input, OnChanges, ChangeDetectionStrategy } from '@angular/core';\r\nimport * as THREE from 'three';\r\n\r\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader.js';\r\nimport { BufferGeometryUtils } from 'three/examples/jsm/utils/BufferGeometryUtils';\r\nimport { vertexShader, fragmentShader } from '../../shader/instanced-shader';\r\nimport { ObjectTransform } from 'src/app/models/object-transform';\r\n\r\n@Component({\r\n  selector: 'pgm-instanced-object',\r\n  templateUrl: './instanced-object.component.html',\r\n  styleUrls: ['./instanced-object.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n\r\n})\r\nexport class InstancedObjectComponent implements OnInit, OnChanges {\r\n  @Input() scene;\r\n  @Input() renderer;\r\n  @Input() changeStep;\r\n  instances;\r\n  @Input() src;\r\n  @Input() mirror;\r\n  @Input() transforms: ObjectTransform[];\r\n  @Input() transform: ObjectTransform;\r\n  @Input() lights = true;\r\n  orientations;\r\n  offsets;\r\n  // speeds;\r\n  instanceBuffer;\r\n  //instanceBufferSpeed;\r\n  vertexShader = vertexShader;\r\n  fragmentShader = fragmentShader;\r\n  constructor() {}\r\n\r\n  ngOnInit() {\r\n    this.init();\r\n  }\r\n\r\n  ngOnChanges() {\r\n    if (this.instanceBuffer) {\r\n      for (let i = 0, ul = this.instances; i < ul; i++) {\r\n        // move out at least 5 units from center in current direction\r\n        this.offsets.setXYZ(\r\n          i,\r\n          this.transforms[i].position.x,\r\n          this.transforms[i].position.y,\r\n          this.transforms[i].position.z,\r\n        );\r\n      }\r\n      this.instanceBuffer.needsUpdate = true;\r\n    }\r\n  }\r\n\r\n  init() {\r\n    this.instances = this.transforms.length;\r\n    const loader = new GLTFLoader().setPath('./assets/models/');\r\n    loader.load(this.src, (gltf: any) => {\r\n      // console.log(gltf.scene);\r\n      // const loadedGeometry = gltf.scene.children[0].geometry;\r\n\r\n      const g1 = gltf.scene.children[0].geometry;\r\n      // const matrix = new THREE.Matrix4();\r\n      let mergeGeometry = new THREE.BufferGeometry();\r\n      mergeGeometry = BufferGeometryUtils.mergeBufferGeometries([g1]);\r\n      if (this.mirror.x) {\r\n        g1.rotateY(Math.PI);\r\n        mergeGeometry = BufferGeometryUtils.mergeBufferGeometries([mergeGeometry, g1]);\r\n        // matrix.set(-1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);\r\n        g1.scale(-1, 1, 1);\r\n        // this.flipNormals(g1);\r\n        mergeGeometry = BufferGeometryUtils.mergeBufferGeometries([mergeGeometry, g1]);\r\n        g1.rotateY(Math.PI);\r\n        mergeGeometry = BufferGeometryUtils.mergeBufferGeometries([mergeGeometry, g1]);\r\n      }\r\n\r\n      const loadedMaterial = gltf.scene.children[0].material;\r\n\r\n      /* const loadedMaterial = new THREE.MeshBasicMaterial();\r\n      loadedMaterial.map = gltf.scene.children[0].material.map; */\r\n\r\n      if (!this.lights) {\r\n        const geometry = mergeGeometry;\r\n\r\n        // per instance data\r\n        this.instanceBuffer = new THREE.InstancedInterleavedBuffer(\r\n          new Float32Array(this.instances * 8),\r\n          8,\r\n          1,\r\n        ).setUsage(THREE.DynamicDrawUsage);\r\n        /* this.instanceBufferSpeed = new THREE.InstancedInterleavedBuffer(\r\n          new Float32Array(this.instances * 8),\r\n          8,\r\n          1,\r\n        ).setUsage(THREE.DynamicDrawUsage); */\r\n        this.offsets = new THREE.InterleavedBufferAttribute(this.instanceBuffer, 3, 0);\r\n        // this.speeds = new THREE.InterleavedBufferAttribute(this.instanceBufferSpeed, 3, 0);\r\n\r\n        const vector = new THREE.Quaternion();\r\n        for (let i = 0, ul = this.instances; i < ul; i++) {\r\n          const x = this.transforms[i].position.x;\r\n          const y = this.transforms[i].position.y;\r\n          const z = this.transforms[i].position.z;\r\n\r\n          // move out at least 5 units from center in current direction\r\n          this.offsets.setXYZ(i, x, y, z);\r\n\r\n          // this.speeds.setXYZ(i, x * 0.01, 0, z * 0.01);\r\n        }\r\n\r\n        geometry.setAttribute('offset', this.offsets); // per mesh translation\r\n\r\n        this.orientations = new THREE.InterleavedBufferAttribute(this.instanceBuffer, 4, 4);\r\n\r\n        for (let i = 0, ul = this.orientations.count; i < ul; i++) {\r\n          vector.setFromEuler(\r\n            new THREE.Euler(\r\n              this.transforms[i].rotation.x,\r\n              this.transforms[i].rotation.y,\r\n              this.transforms[i].rotation.z,\r\n            ),\r\n          );\r\n          // vector.normalize();\r\n          this.orientations.setXYZW(i, 0, vector.y, 0, 1);\r\n\r\n          this.orientations.setXYZW(i, vector.x, vector.y, vector.z, vector.w);\r\n          // this.orientations.setY( i, vector.y );\r\n        }\r\n\r\n        geometry.setAttribute('orientation', this.orientations); // per mesh orientation\r\n\r\n        // material\r\n        const texture = loadedMaterial.map;\r\n        let ambientMap;\r\n        if (gltf.scene.children[0].geometry.attributes.uv2) {\r\n          ambientMap = new THREE.TextureLoader().load('./assets/textures/stoa-floor-ao.jpg');\r\n        }\r\n\r\n        if (texture) {\r\n          texture.anisotropy = this.renderer.capabilities.getMaxAnisotropy();\r\n        }\r\n\r\n        const material = new THREE.RawShaderMaterial({\r\n          uniforms: {\r\n            map: { value: texture },\r\n            ambientMap,\r\n          },\r\n          vertexShader: this.vertexShader,\r\n          fragmentShader: this.fragmentShader,\r\n          side: THREE.FrontSide,\r\n          transparent: false,\r\n        });\r\n\r\n        const mesh = new THREE.Mesh(geometry, material);\r\n        if (this.transform && this.transform.rotation) {\r\n          mesh.rotation.set(\r\n            this.transform.rotation.x,\r\n            this.transform.rotation.y,\r\n            this.transform.rotation.z,\r\n          );\r\n        }\r\n        if (this.transform && this.transform.position) {\r\n          mesh.position.set(\r\n            this.transform.position.x,\r\n            this.transform.position.y,\r\n            this.transform.position.z,\r\n          );\r\n        }\r\n        mesh.frustumCulled = false;\r\n        mesh.matrixAutoUpdate = false;\r\n        mesh.updateMatrix();\r\n        this.scene.add(mesh);\r\n      } else {\r\n        var count = this.transforms.length;\r\n\r\n        if (gltf.scene.children[0].geometry.attributes.uv2) {\r\n          let aoMap = new THREE.TextureLoader().load(\r\n            'assets/textures/stoa-floor-ao.png',\r\n            (texture) => {\r\n              texture.needsUpdate = true;\r\n              texture.flipY = false;\r\n            },\r\n          );\r\n          loadedMaterial.aoMap = aoMap;\r\n          loadedMaterial.aoMapIntensity = 2;\r\n        }\r\n\r\n        var mesh = new THREE.InstancedMesh(mergeGeometry, loadedMaterial, count);\r\n\r\n        var dummy = new THREE.Object3D();\r\n\r\n        for (var i = 0; i < count; i++) {\r\n          dummy.position.set(\r\n            this.transforms[i].position.x,\r\n            this.transforms[i].position.y,\r\n            this.transforms[i].position.z,\r\n          );\r\n\r\n          dummy.rotation.set(\r\n            this.transforms[i].rotation.x,\r\n            this.transforms[i].rotation.y,\r\n            this.transforms[i].rotation.z,\r\n          );\r\n\r\n          dummy.updateMatrix();\r\n\r\n          mesh.setMatrixAt(i, dummy.matrix);\r\n        }\r\n      }\r\n      if (this.transform && this.transform.rotation) {\r\n        mesh.rotation.set(\r\n          this.transform.rotation.x,\r\n          this.transform.rotation.y,\r\n          this.transform.rotation.z,\r\n        );\r\n      }\r\n      if (this.transform && this.transform.position) {\r\n        mesh.position.set(\r\n          this.transform.position.x,\r\n          this.transform.position.y,\r\n          this.transform.position.z,\r\n        );\r\n      }\r\n      mesh.matrixAutoUpdate = false;\r\n\r\n      mesh.updateMatrix();\r\n      this.scene.add(mesh);\r\n    });\r\n  }\r\n\r\n  flipNormals(geometry) {\r\n    // console.log(geometry);\r\n    let temp = 0;\r\n    // let face;\r\n\r\n    // flip every vertex normal in geometry by multiplying normal by -1\r\n    for (let i = 0; i < geometry.faces.length; i++) {\r\n      const face = geometry.faces[i];\r\n      face.normal.x = -1 * face.normal.x;\r\n      face.normal.y = 1 * face.normal.y;\r\n      face.normal.z = 1 * face.normal.z;\r\n\r\n      face.vertexNormals[0].x = -1 * face.vertexNormals[0].x;\r\n      face.vertexNormals[0].y = 1 * face.vertexNormals[0].y;\r\n      face.vertexNormals[0].z = 1 * face.vertexNormals[0].z;\r\n\r\n      face.vertexNormals[1].x = -1 * face.vertexNormals[1].x;\r\n      face.vertexNormals[1].y = 1 * face.vertexNormals[1].y;\r\n      face.vertexNormals[1].z = 1 * face.vertexNormals[1].z;\r\n\r\n      face.vertexNormals[2].x = -1 * face.vertexNormals[2].x;\r\n      face.vertexNormals[2].y = 1 * face.vertexNormals[2].y;\r\n      face.vertexNormals[2].z = 1 * face.vertexNormals[2].z;\r\n\r\n      temp = face.vertexNormals[0];\r\n      face.vertexNormals[0] = face.vertexNormals[2];\r\n      face.vertexNormals[2] = temp;\r\n    }\r\n\r\n    /*     for (let i = 0; i < geometry.vertices.length; i++) {\r\n      const vertex = geometry.vertices[i];\r\n      vertex.normal.x = -1 * vertex.normal.x;\r\n      vertex.normal.y = -1 * vertex.normal.y;\r\n      vertex.normal.z = -1 * vertex.normal.z;\r\n    } */\r\n\r\n    // change face winding order\r\n    for (let i = 0; i < geometry.faces.length; i++) {\r\n      const face = geometry.faces[i];\r\n      temp = face.a;\r\n      face.a = face.c;\r\n      face.c = temp;\r\n    }\r\n\r\n    // flip UV coordinates\r\n\r\n    const faceVertexUvs = geometry.faceVertexUvs[0];\r\n    for (let i = 0; i < faceVertexUvs.length; i++) {\r\n      temp = faceVertexUvs[i][0];\r\n      faceVertexUvs[i][0] = faceVertexUvs[i][2];\r\n      faceVertexUvs[i][2] = temp;\r\n    }\r\n\r\n    geometry.verticesNeedUpdate = true;\r\n    geometry.normalsNeedUpdate = true;\r\n    geometry.vertexNormalsNeedUpdate = true;\r\n\r\n    /* geometry.computeFaceNormals();\r\n    geometry.computeVertexNormals(); */\r\n    geometry.computeBoundingSphere();\r\n  }\r\n}\r\n","// This file can be replaced during build by using the `fileReplacements` array.\r\n// `ng build --prod` replaces `environment.ts` with `environment.prod.ts`.\r\n// The list of file replacements can be found in `angular.json`.\r\n\r\nexport const environment = {\r\n  production: false\r\n};\r\n\r\n/*\r\n * For easier debugging in development mode, you can import the following file\r\n * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.\r\n *\r\n * This import should be commented out in production mode because it will have a negative impact\r\n * on performance if an error is thrown.\r\n */\r\n// import 'zone.js/dist/zone-error';  // Included with Angular CLI.\r\n","export default \"\";","import { Injectable } from '@angular/core';\nimport * as THREE from 'three';\nimport { ControlStateService } from './control-state.service';\nimport { Vector3 } from 'yuka';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class CameraPositionService {\n  direction = new Vector3();\n\n  constructor(public controlStateService: ControlStateService) { }\n\n\n  public updateCamera(player: any, deltaTime: number) {\n    const state = this.controlStateService.getControlState();\n\n    //player.getDirection(this.direction);\n\n    //console.log(this.direction);\n    this.direction.x = Math.sin(player.rotation.y);\n    this.direction.z = Math.cos(player.rotation.y);\n    const slowdown = 5;\n\n    if (state.forward === true) {\n      player.position.z -= this.direction.z / slowdown * deltaTime;\n      player.position.x -= this.direction.x / slowdown * deltaTime;\n    }\n    if (state.backwards === true) {\n      player.position.z += this.direction.z / slowdown * deltaTime;\n      player.position.x += this.direction.x / slowdown * deltaTime;\n    }\n    if (state.right === true) {\n      player.rotation.y -= 6 * Math.PI / 360 * deltaTime;\n    }\n    if (state.left === true) {\n      player.rotation.y += 6 * Math.PI / 360 * deltaTime;\n    }\n\n    if (state.mouseIsDown === true) {\n      player.position.z -= this.direction.z / slowdown * deltaTime;\n      player.position.x -= this.direction.x / slowdown * deltaTime;\n      player.rotation.y += -state.mouseX * 3 * Math.PI / 360 * deltaTime;\n    }\n\n    /* if (player.position.x < 2) {\n      player.position.x = 2;\n    }\n    if (player.position.x > 8) {\n      player.position.x = 8;\n    } */\n  }\n}\n","import { ChangeDetectionStrategy, Component, OnInit, ɵPlayer } from '@angular/core';\r\nimport * as THREE from 'three';\r\nimport * as YUKA from 'yuka';\r\nimport { Player } from '../Player.js';\r\n\r\nimport Stats from 'three/examples/jsm/libs/stats.module.js';\r\n\r\n// import { FirstPersonControls } from 'three/examples/jsm/controls/FirstPersonControls';\r\n// import { MapControls } from 'three/examples/jsm/controls/OrbitControls';\r\n// import { CannonPhysics } from 'three/examples/jsm/physics/CannonPhysics.js';\r\n\r\nimport { Entity } from 'src/app/models/entity';\r\nimport { EntityService } from 'src/app/services/entity.service';\r\nimport { SkyService } from 'src/app/services/sky.service';\r\nimport { CameraPositionService } from 'src/app/services/camera-position.service';\r\n\r\n@Component({\r\n  selector: 'pgm-stage',\r\n  templateUrl: './stage.component.html',\r\n  styleUrls: ['./stage.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n\r\n})\r\nexport class StageComponent implements OnInit {\r\n  container;\r\n  stats: Stats;\r\n\r\n  camera: THREE.PerspectiveCamera;\r\n  scene: THREE.Scene;\r\n  renderer: THREE.WebGLRenderer;\r\n  entities: Entity[];\r\n  deltaTime = 1;\r\n  entityManager: YUKA.EntityManager;\r\n  time: YUKA.time;\r\n  player: Player;\r\n\r\n  // controls;\r\n  clock: THREE.Clock;\r\n\r\n  constructor(\r\n    public entityService: EntityService,\r\n    public skyService: SkyService,\r\n    public cameraPositionService: CameraPositionService,\r\n  ) {}\r\n\r\n  ngOnInit() {\r\n    this.entityService.createEntities();\r\n    this.entities = this.entityService.getEntities();\r\n    this.init();\r\n  }\r\n\r\n  init() {\r\n    this.clock = new THREE.Clock();\r\n    this.entityManager = new YUKA.EntityManager();\r\n    this.time = new YUKA.Time();\r\n\r\n    this.container = document.getElementById('container');\r\n\r\n    this.camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 0.3, 500);\r\n    /*    this.camera.position.x = 5;\r\n       this.camera.position.y = 1.6;\r\n       this.camera.position.z = -5; */\r\n    this.camera.matrixAutoUpdate = false;\r\n    // this.camera.rotation.y = Math.PI;\r\n\r\n    this.scene = new THREE.Scene();\r\n\r\n    this.renderer = new THREE.WebGLRenderer();\r\n\r\n    /*  this.controls.enableDamping = true; // an animation loop is required when either damping or auto-rotation are enabled\r\n        this.controls.dampingFactor = 0.05;\r\n        this.controls.screenSpacePanning = false;\r\n        this.controls.minDistance = 5;\r\n        this.controls.maxDistance = 200;\r\n        this.controls.maxPolarAngle = Math.PI / 2.015;\r\n        this.controls.target.set(0, 0, 60);\r\n     */\r\n    \r\n    this.skyService.makeSky(this.scene);\r\n\r\n  /*   if (this.renderer.extensions.get('ANGLE_instanced_arrays') === null) {\r\n      //document.getElementById('notSupported').style.display = '';\r\n      return;\r\n    } */\r\n    this.renderer.setPixelRatio(window.devicePixelRatio);\r\n    this.renderer.setSize(window.innerWidth, window.innerHeight);\r\n    this.container.appendChild(this.renderer.domElement);\r\n    \r\n    this.stats = Stats();\r\n    this.container.appendChild(this.stats.dom);\r\n\r\n    /*     this.controls = new FirstPersonControls(this.camera, this.renderer.domElement);\r\n        this.controls.movementSpeed = 10;\r\n        this.controls.lookSpeed = 0.1;\r\n        this.controls.lookAt(0, 0, 0);\r\n    \r\n        this.controls.constrainVertical = true;\r\n        this.controls.verticalMax = Math.PI * .55;\r\n        this.controls.verticalMin = Math.PI * .35; */\r\n\r\n    this.player = new Player();\r\n    const loader2 = new YUKA.NavMeshLoader();\r\n    loader2.load('./assets/models/navmesh.glb', { epsilonCoplanarTest: 0.25 }).then((navMesh) => {\r\n      // visualize convex regions\r\n\r\n      // const navMeshGroup = createConvexRegionHelper( navMesh );\r\n      // scene.add( navMeshGroup );\r\n\r\n      this.player.navMesh = navMesh;\r\n      this.player.head.setRenderComponent(this.camera, this.sync);\r\n\r\n      this.player.position.set(5, 0, -5);\r\n      this.entityManager.add(this.player);\r\n\r\n      // const loadingScreen = document.getElementById( 'loading-screen' );\r\n\r\n      // loadingScreen.classList.add( 'fade-out' );\r\n      // loadingScreen.addEventListener( 'transitionend', onTransitionEnd );\r\n\r\n      // animate();\r\n    });\r\n    \r\n    this.animate();\r\n  }\r\n\r\n  onWindowResize() {\r\n    console.log('resize');\r\n    // this.controls.handleResize();\r\n    this.camera.aspect = window.innerWidth / window.innerHeight;\r\n    this.camera.updateProjectionMatrix();\r\n\r\n    this.renderer.setSize(window.innerWidth, window.innerHeight);\r\n  }\r\n\r\n  animate() {\r\n    requestAnimationFrame(this.animate.bind(this));\r\n    this.render();\r\n  }\r\n\r\n  render() {\r\n    this.stats.update();\r\n    // this.deltaTime = this.clock.getDelta();\r\n    const delta = this.time.update().getDelta();\r\n    this.cameraPositionService.updateCamera(this.player, delta * 30);\r\n\r\n    this.entityManager.update(delta);\r\n    this.camera.position.x = this.player.position.x;\r\n    this.camera.position.y = this.player.position.y + this.player.height;\r\n    this.camera.position.z = this.player.position.z;\r\n    this.camera.rotation.x = this.player.rotation.x;\r\n    this.camera.rotation.y = this.player.rotation.y;\r\n    this.camera.rotation.z = this.player.rotation.z;\r\n\r\n    // console.log(this.player.position.x);\r\n\r\n    // controls.update( delta );\r\n\r\n    this.camera.updateProjectionMatrix();\r\n    this.camera.updateMatrix();\r\n    this.renderer.render(this.scene, this.camera);\r\n  }\r\n\r\n  sync(entity, renderComponent) {\r\n    // renderComponent.matrixWorld.copy(entity.worldMatrix);\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\nimport { ENTITIES } from '../data/entities';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class EntityService {\n  constructor() {}\n\n  public getEntities() {\n    return ENTITIES;\n  }\n\n  public createEntities() {\n    const entities = this.getEntities();\n    for (let n = 0; n < entities.length; n++) {\n      switch (entities[n].src) {\n        case 'capitol.glb':\n          for (let i = 0; i < 2; i++) {\n            const posX = i * 9.65;\n            const posZ = 2.645 * 4;\n            const posY = 4.35 + 0.225;\n            // const rotY = Math.random() * Math.PI;\n\n            for (let k = 0; k < 100; k++) {\n              entities[n].transforms.push({\n                rotation: { x: Math.PI, y: 0, z: 0 },\n\n                position: { x: posX, y: posY, z: posZ - k * 2.645 },\n              });\n            }\n            // move out at least 5 units from center in current direction\n          }\n          break;\n\n        case 'hall-ceiling.glb':\n          for (let i = 0; i < 2; i++) {\n            const posX = i * 9.65;\n            const posZ = 2.645 * 4;\n            const posY = 5.00371;\n            // const rotY = Math.random() * Math.PI;\n\n            for (let k = 0; k < 100; k++) {\n              entities[n].transforms.push({\n                rotation: { x: 0, y: i * Math.PI, z: 0 },\n\n                position: { x: posX, y: posY, z: posZ - k * (2.645 / 2) },\n              });\n            }\n            // move out at least 5 units from center in current direction\n          }\n          break;\n\n        case 'pedistal.glb':\n          for (let i = 0; i < 2; i++) {\n            const posX = i * 9.65;\n            const posZ = 2.645 * 4;\n            const posY = 0.5 + 0.225;\n            // const rotY = Math.random() * Math.PI;\n\n            for (let k = 0; k < 100; k++) {\n              entities[n].transforms.push({\n                rotation: { x: Math.PI, y: 0, z: 0 },\n\n                position: { x: posX, y: posY, z: posZ - k * 2.645 },\n              });\n            }\n            // move out at least 5 units from center in current direction\n          }\n          break;\n\n        case 'shaft.glb':\n          for (let i = 0; i < 2; i++) {\n            const posX = i * 9.65;\n            const posZ = 2.645 * 4;\n            const posY = 0.5 + 0.225;\n            // const rotY = Math.random() * Math.PI;\n\n            for (let k = 0; k < 100; k++) {\n              entities[n].transforms.push({\n                rotation: { x: 0, y: 0, z: 0 },\n\n                position: { x: posX, y: posY, z: posZ - k * 2.645 },\n              });\n            }\n            // move out at least 5 units from center in current direction\n          }\n          break;\n\n        case 'chamber.glb':\n          for (let i = 0; i < 1; i++) {\n            const posX = -5.2;\n            const posZ = 0;\n            const posY = 0 + 0.225;\n            // const rotY = Math.random() * Math.PI;\n\n            for (let k = 0; k < 20; k++) {\n              entities[n].transforms.push({\n                rotation: { x: 0, y: 0, z: 0 },\n\n                position: { x: posX, y: posY, z: posZ - 4.454 * k },\n              });\n            }\n\n            for (let k = 0; k < 18; k++) {\n              entities[n].transforms.push({\n                rotation: { x: 0, y: Math.PI, z: 0 },\n\n                position: { x: 15.2, y: posY, z: posZ - 4.454 * k },\n              });\n            }\n            // move out at least 5 units from center in current direction\n          }\n          break;\n\n        case 'portal-pillar.glb':\n          entities[n].transforms.push({\n            rotation: { x: 0, y: -Math.PI / 4, z: 0 },\n\n            position: { x: 2.582, y: -2.25, z: 15.6291 },\n          });\n\n          entities[n].transforms.push({\n            rotation: { x: 0, y: (Math.PI / 4) * 3, z: 0 },\n\n            position: { x: 5.6107, y: -2.25, z: 18.3544 },\n          });\n\n          // move out at least 5 units from center in current direction\n\n          break;\n\n        case 'column-court.glb':\n          const posZ = -36.6416;\n          const posY = 2.70996;\n          const distance = 34.0016 - 36.6416;\n          for (let i = 0; i < 2; i++) {\n            const posX = -11.4742 + i * 11.4742 * 2;\n            // const rotY = Math.random() * Math.PI;\n\n            for (let k = 0; k < 11; k++) {\n              entities[n].transforms.push({\n                rotation: { x: 0, y: 0, z: 0 },\n\n                position: { x: posX, y: posY, z: posZ - k * distance },\n              });\n            }\n            // move out at least 5 units from center in current direction\n          }\n          for (let k = 1; k < 9; k++) {\n            const distance = -11.4758 + 8.92584;\n            const posX = -11.4742 - k * distance;\n            const posZ = -36.6416;\n            entities[n].transforms.push({\n              rotation: { x: 0, y: 0, z: 0 },\n              position: { x: posX, y: posY, z: posZ },\n            });\n          }\n          break;\n\n        case 'corinthian-capital.glb':\n          for (let i = 0; i < 2; i++) {\n            const posZ = -36.6416;\n            const posY = 2.70996;\n            const distance = 34.0016 - 36.6416;\n            const posX = -11.4742 + i * 11.4742 * 2;\n            // const rotY = Math.random() * Math.PI;\n\n            for (let k = 0; k < 11; k++) {\n              entities[n].transforms.push({\n                rotation: { x: 0, y: 0, z: 0 },\n\n                position: { x: posX, y: posY, z: posZ - k * distance },\n              });\n            }\n            // move out at least 5 units from center in current direction\n          }\n          for (let k = 1; k < 9; k++) {\n            const distance = -11.4758 + 8.92584;\n            const posX = -11.4742 - k * distance;\n            const posY = 2.70996;\n            const posZ = -36.6416;\n            entities[n].transforms.push({\n              rotation: { x: 0, y: 0, z: 0 },\n              position: { x: posX, y: posY, z: posZ },\n            });\n          }\n          break;\n\n        default:\n          if (!entities[n].transforms || entities[n].transforms.length === 0) {\n            entities[n].transforms.push({\n              rotation: { x: 0, y: 0, z: 0 },\n\n              position: { x: 0, y: 0, z: 0 },\n            });\n          }\n\n          // move out at least 5 units from center in current direction\n\n          break;\n      }\n    }\n  }\n}\n","import { Component, OnInit, HostListener, ChangeDetectionStrategy } from '@angular/core';\nimport { ControlState } from 'src/app/models/control-state';\nimport { ControlStateService } from 'src/app/services/control-state.service';\n\n@Component({\n  selector: 'pgm-controls',\n  templateUrl: './controls.component.html',\n  styleUrls: ['./controls.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n\n})\nexport class ControlsComponent implements OnInit {\n  controlState: ControlState\n\n  @HostListener('document:mousedown', ['$event'])\n  onMouseDown(ev: MouseEvent) {\n    ev.preventDefault();\n    // this.controlState.forward = true;\n    this.controlState.mouseIsDown = true;\n    this.controlState.mouseX = (ev.clientX / window.innerWidth - .5) * 2;\n    this.controlState.mouseY = (ev.clientY / window.innerHeight - .5) * 2;\n    // console.log(this.controlState.mouseX);\n    // console.log(ev.clientX)\n  }\n\n  @HostListener('document:mousemove', ['$event'])\n  onMouseMove(ev: MouseEvent) {\n    ev.preventDefault();\n    this.controlState.mouseX = (ev.clientX / window.innerWidth - .5) * 2;\n    this.controlState.mouseY = (ev.clientY / window.innerHeight - .5) * 2;\n    // console.log(this.controlState.mouseX);\n  }\n\n  @HostListener('document:mouseup', ['$event'])\n  onMouseUp(ev: MouseEvent) {\n    ev.preventDefault();\n    this.controlState.mouseIsDown = false;\n  }\n\n  @HostListener('document:touchstart', ['$event'])\n  onPointerDown(ev: TouchEvent) {\n    // ev.preventDefault();\n    this.controlState.mouseIsDown = true;\n    this.controlState.mouseX = (ev.touches[0].clientX / window.innerWidth - .5) * 2;\n    this.controlState.mouseY = (ev.touches[0].clientY / window.innerHeight - .5) * 2;\n  }\n\n  @HostListener('document:touchmove', ['$event'])\n  onPointerMove(ev: TouchEvent) {\n    // ev.preventDefault();\n    // console.log(ev);\n    this.controlState.mouseX = (ev.touches[0].clientX / window.innerWidth - .5) * 2;\n    this.controlState.mouseY = (ev.touches[0].clientY / window.innerHeight - .5) * 2;\n    // console.log(this.controlState.mouseX);\n  }\n\n  @HostListener('document:touchend', ['$event'])\n  onTouchEnd(ev: TouchEvent) {\n    // ev.preventDefault();\n    this.controlState.mouseIsDown = false;\n  }\n\n  @HostListener('document:keydown', ['$event'])\n  onKeyDown(ev: KeyboardEvent) {\n    // console.log(`The user just pressed ${ev.key}!`);\n    switch (ev.keyCode) {\n      case 38: /*up*/\n      case 87: /*W*/\n        this.controlState.forward = true;\n        break;\n      case 40: /*down*/\n      case 83: /*S*/\n        this.controlState.backwards = true;\n        break;\n      case 37: /*left*/\n      case 65: /*A*/\n        this.controlState.left = true;\n        break;\n      case 39: /*right*/\n      case 68: /*D*/\n        this.controlState.right = true;\n        break;\n    }\n  }\n\n  @HostListener('document:keyup', ['$event'])\n  onKeyUp(ev: KeyboardEvent) {\n    // console.log(`The user just released ${ev.key}!`);\n    switch (ev.keyCode) {\n      case 38: /*up*/\n      case 87: /*W*/\n        this.controlState.forward = false;\n        break;\n      case 40: /*down*/\n      case 83: /*S*/\n        this.controlState.backwards = false;\n        break;\n      case 37: /*left*/\n      case 65: /*A*/\n        this.controlState.left = false;\n        break;\n      case 39: /*right*/\n      case 68: /*D*/\n        this.controlState.right = false;\n        break;\n    }\n  }\n\n\n  constructor(public controlStateService: ControlStateService) { }\n\n  ngOnInit(): void {\n    this.controlState = this.controlStateService.getControlState();\n  }\n\n}\n","export default \"\\n\";","export default \":host {\\n  display: block;\\n  width: 100%;\\n  height: 100%;\\n  -webkit-user-select: none;\\n     -moz-user-select: none;\\n          user-select: none;\\n}\\n\\na {\\n  color: #08f;\\n}\\n\\n#notSupported {\\n  width: 50%;\\n  margin: auto;\\n  background-color: #f00;\\n  margin-top: 20px;\\n  padding: 10px;\\n}\\n\\n.container {\\n  width: 100%;\\n  height: 100%;\\n  -webkit-user-select: none;\\n     -moz-user-select: none;\\n          user-select: none;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uXFwuLlxcLi5cXC4uXFxzdGFnZS5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGNBQUE7RUFDQSxXQUFBO0VBQ0EsWUFBQTtFQUNBLHlCQUFBO0tBQUEsc0JBQUE7VUFBQSxpQkFBQTtBQUNGOztBQUNBO0VBQ0UsV0FBQTtBQUVGOztBQUFBO0VBQ0UsVUFBQTtFQUNBLFlBQUE7RUFDQSxzQkFBQTtFQUNBLGdCQUFBO0VBQ0EsYUFBQTtBQUdGOztBQUFBO0VBQ0UsV0FBQTtFQUNBLFlBQUE7RUFDQSx5QkFBQTtLQUFBLHNCQUFBO1VBQUEsaUJBQUE7QUFHRiIsImZpbGUiOiJzdGFnZS5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIjpob3N0IHtcclxuICBkaXNwbGF5OiBibG9jaztcclxuICB3aWR0aDoxMDAlO1xyXG4gIGhlaWdodDoxMDAlO1xyXG4gIHVzZXItc2VsZWN0OiBub25lO1xyXG59XHJcbmEge1xyXG4gIGNvbG9yOiAjMDhmO1xyXG59XHJcbiNub3RTdXBwb3J0ZWQge1xyXG4gIHdpZHRoOiA1MCU7XHJcbiAgbWFyZ2luOiBhdXRvO1xyXG4gIGJhY2tncm91bmQtY29sb3I6ICNmMDA7XHJcbiAgbWFyZ2luLXRvcDogMjBweDtcclxuICBwYWRkaW5nOiAxMHB4O1xyXG59XHJcblxyXG4uY29udGFpbmVyIHtcclxuICB3aWR0aDoxMDAlO1xyXG4gIGhlaWdodDogMTAwJTtcclxuICB1c2VyLXNlbGVjdDogbm9uZTtcclxufVxyXG4iXX0= */\";","import { Component } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-root',\r\n  templateUrl: './app.component.html',\r\n  styleUrls: ['./app.component.scss']\r\n})\r\nexport class AppComponent {\r\n  title = 'pergamon';\r\n}\r\n","export default \"<pgm-stage></pgm-stage>\\r\\n\";","export let vertexShader = `precision highp float;\r\n\r\n  uniform mat4 modelViewMatrix;\r\n  uniform mat4 projectionMatrix;\r\n\r\n  attribute vec3 position;\r\n  attribute vec3 offset;\r\n  attribute vec2 uv;\r\n  attribute vec4 orientation;\r\n\r\n  varying vec2 vUv;\r\n\r\n  // http://www.geeks3d.com/20141201/how-to-rotate-a-vertex-by-a-quaternion-in-glsl/\r\n\r\n  vec3 applyQuaternionToVector( vec4 q, vec3 v ){\r\n\r\n    return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );\r\n\r\n  }\r\n\r\n  void main() {\r\n\r\n    vec3 vPosition = applyQuaternionToVector( orientation, position );\r\n\r\n    vUv = uv;\r\n\r\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( offset + vPosition, 1.0 );\r\n\r\n  }`;\r\n\r\nexport let fragmentShader = `precision highp float;\r\n\r\n  uniform sampler2D map;\r\n\r\n  varying vec2 vUv;\r\n\r\n  void main() {\r\n\r\n    gl_FragColor = texture2D(map, vUv);\r\n\r\n  }`;\r\n","import { Injectable } from '@angular/core';\r\nimport * as THREE from 'three';\r\nimport { Sky } from 'three/examples/jsm/objects/Sky';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class SkyService {\r\n\r\n  constructor() { }\r\n  public makeSky(scene) {\r\n    const light = new THREE.DirectionalLight(0xffffff, 0.8);\r\n    light.target.position.set(0, 0, 0);\r\n    const hemilight = new THREE.HemisphereLight(0xffffbb, 0x645f55, 0.8);\r\n    scene.add(hemilight);\r\n\r\n    scene.add(light);\r\n\r\n    const sky = new Sky();\r\n    sky.scale.setScalar(10000);\r\n    scene.add(sky);\r\n    const uniforms = sky.material.uniforms;\r\n    uniforms.turbidity.value = 10;\r\n    uniforms.rayleigh.value = 2;\r\n    //uniforms.luminance.value = 1;\r\n    uniforms.mieCoefficient.value = 0.005;\r\n    uniforms.mieDirectionalG.value = 0.8;\r\n    const parameters = {\r\n      distance: 400,\r\n      inclination: 0.15,\r\n      azimuth: 0.3\r\n    };\r\n\r\n    const theta = Math.PI * (parameters.inclination - 0.5);\r\n    const phi = 2 * Math.PI * (parameters.azimuth - 0.5);\r\n\r\n    light.position.x = parameters.distance * Math.cos(phi);\r\n    light.position.y = parameters.distance * Math.sin(phi) * Math.sin(theta);\r\n    light.position.z = parameters.distance * Math.sin(phi) * Math.cos(theta);\r\n    sky.material.uniforms.sunPosition.value = light.position.copy(\r\n      light.position\r\n    );\r\n    light.position.z = -parameters.distance * Math.sin(phi) * Math.cos(theta);\r\n\r\n  }\r\n}\r\n","import { BrowserModule } from '@angular/platform-browser';\r\nimport { NgModule } from '@angular/core';\r\n\r\nimport { AppRoutingModule } from './app-routing.module';\r\nimport { AppComponent } from './app.component';\r\nimport { StageComponent } from './components/stage/stage.component';\r\nimport { InstancedObjectComponent } from './components/instanced-object/instanced-object.component';\nimport { ControlsComponent } from './components/controls/controls.component';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    AppComponent,\r\n    StageComponent,\r\n    InstancedObjectComponent,\r\n    ControlsComponent\r\n  ],\r\n  imports: [\r\n    BrowserModule,\r\n    AppRoutingModule\r\n  ],\r\n  providers: [],\r\n  bootstrap: [AppComponent]\r\n})\r\nexport class AppModule { }\r\n","/**\n * @author Mugen87 / https://github.com/Mugen87\n */\n\nimport { MovingEntity, GameEntity, Vector3 } from 'yuka';\n\nconst startPosition = new Vector3();\nconst endPosition = new Vector3();\n\nclass Player extends MovingEntity {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.maxSpeed = 4;\n\t\tthis.height = 2;\n\n\t\tthis.head = new GameEntity();\n\t\tthis.add( this.head );\n\n\t\tthis.updateOrientation = false;\n\t\tthis.navMesh = null;\n\t\tthis.currentRegion = null;\n\n\t}\n\n\tupdate( delta ) {\n\n\t\tstartPosition.copy( this.position );\n\n\t\tsuper.update( delta );\n\n\t\tendPosition.copy( this.position );\n\n\t\t// ensure the entity stays inside its navmesh\n\n\t\tthis.currentRegion = this.navMesh.clampMovement(\n\t\t\tthis.currentRegion,\n\t\t\tstartPosition,\n\t\t\tendPosition,\n\t\t\tthis.position\n\t\t);\n\n\t\t// adjust height of player according to the ground\n\n\t\tconst distance = this.currentRegion.distanceToPoint( this.position );\n\n\t\tthis.position.y -= distance * 0.2; // smooth transition\n\n\t}\n\n}\n\n\nexport { Player };\n","import { Entity } from '../models/entity';\r\n\r\nexport let ENTITIES: Entity[] = [\r\n  { src: 'capitol.glb', transforms: [], static: true, mirror: { x: true, y: true } },\r\n  {\r\n    src: 'corinthian-capital.glb',\r\n    transform: {\r\n      rotation: { x: 0, y: (Math.PI / 180) * -40.5, z: 0 },\r\n      position: { x: -18.7705, z: 52.6765, y: -5.02641 },\r\n    },\r\n    transforms: [],\r\n    static: true,\r\n    mirror: { x: false, y: false },\r\n  },\r\n  { src: 'pedistal.glb', transforms: [], static: true, mirror: { x: false, y: false } },\r\n  { src: 'shaft.glb', transforms: [], static: true, mirror: { x: false, y: false } },\r\n  {\r\n    src: 'column-court.glb',\r\n    transform: {\r\n      rotation: { x: 0, y: (Math.PI / 180) * -40.5, z: 0 },\r\n      position: { x: -18.7705, z: 52.6765, y: -5.02641 },\r\n    },\r\n    transforms: [],\r\n    static: true,\r\n    mirror: { x: false, y: false },\r\n  },\r\n  { src: 'chamber.glb', transforms: [], static: true, mirror: { x: false, y: false } },\r\n  { src: 'road.glb', transforms: [], static: true, mirror: { x: false, y: false } },\r\n  { src: 'stoa-floor.glb', transforms: [], static: true, mirror: { x: false, y: false } },\r\n  { src: 'stairs.glb', transforms: [], static: true, mirror: { x: false, y: false } },\r\n  { src: 'portal-pillar.glb', transforms: [], static: true, mirror: { x: false, y: false } },\r\n  { src: 'roof.glb', transforms: [], static: true, mirror: { x: false, y: false } },\r\n  { src: 'architrave.glb', transforms: [], static: true, mirror: { x: false, y: false } },\r\n  { src: 'hall-ceiling.glb', transforms: [], static: true, mirror: { x: false, y: false } },\r\n  {\r\n    src: 'propylon-walls.glb',\r\n    transforms: [\r\n      {\r\n        rotation: { x: 0, y: (Math.PI / 180) * -40.5, z: 0 },\r\n        position: { x: -18.7705, z: 52.6765, y: -5.02641 },\r\n      },\r\n    ],\r\n    static: true,\r\n    mirror: { x: false, y: false },\r\n  },\r\n  {\r\n    src: 'propylon-court-walls.glb',\r\n    transforms: [\r\n      {\r\n        rotation: { x: 0, y: (Math.PI / 180) * -40.5, z: 0 },\r\n        position: { x: -18.7705, z: 52.6765, y: -5.02641 },\r\n      },\r\n    ],\r\n    static: true,\r\n    mirror: { x: false, y: false },\r\n  },\r\n  {\r\n    src: 'propylon-court-floor.glb',\r\n    transforms: [\r\n      {\r\n        rotation: { x: 0, y: (Math.PI / 180) * -40.5, z: 0 },\r\n        position: { x: -18.7705, z: 52.6765, y: -5.02641 },\r\n      },\r\n    ],\r\n    static: true,\r\n    mirror: { x: false, y: false },\r\n  },\r\n  {\r\n    src: 'propylon-architrave.glb',\r\n    transforms: [\r\n      {\r\n        rotation: { x: 0, y: (Math.PI / 180) * -40.5, z: 0 },\r\n        position: { x: -18.7705, z: 52.6765, y: -5.02641 },\r\n      },\r\n    ],\r\n    static: true,\r\n    mirror: { x: false, y: false },\r\n  },\r\n  {\r\n    src: 'propylon-court-architrave.glb',\r\n    transforms: [\r\n      {\r\n        rotation: { x: 0, y: (Math.PI / 180) * -40.5, z: 0 },\r\n        position: { x: -18.7705, z: 52.6765, y: -5.02641 },\r\n      },\r\n    ],\r\n    static: true,\r\n    mirror: { x: false, y: false },\r\n  },\r\n  // { src: 'navmesh.glb', transforms: [], static: true, mirror: { x: false, y: false } },\r\n];\r\n","import { Injectable } from '@angular/core';\nimport { CONTROLS } from '../data/controls';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ControlStateService {\n\n  constructor() { }\n\n\n  public getControlState() {\n    return CONTROLS;\n  }\n}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJpbnN0YW5jZWQtb2JqZWN0LmNvbXBvbmVudC5zY3NzIn0= */\";","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\n\r\nconst routes: Routes = [];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forRoot(routes, { relativeLinkResolution: 'legacy' })],\r\n  exports: [RouterModule]\r\n})\r\nexport class AppRoutingModule { }\r\n","import { ControlState } from '../models/control-state';\r\n\r\nexport let CONTROLS: ControlState = {\r\n    forward: false,\r\n    backwards: false,\r\n    left: false,\r\n    right: false,\r\n    mouseIsDown: false,\r\n    mouseX: 0,\r\n    mouseY: 0\r\n};","export default \":host {\\n  display: block;\\n  width: 100%;\\n  height: 100%;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uXFwuLlxcYXBwLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0ksY0FBQTtFQUNBLFdBQUE7RUFDQSxZQUFBO0FBQ0oiLCJmaWxlIjoiYXBwLmNvbXBvbmVudC5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiOmhvc3Qge1xyXG4gICAgZGlzcGxheTogYmxvY2s7XHJcbiAgICB3aWR0aDoxMDAlO1xyXG4gICAgaGVpZ2h0OjEwMCU7XHJcbn0iXX0= */\";","import { enableProdMode } from '@angular/core';\r\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\r\n\r\nimport { AppModule } from './app/app.module';\r\nimport { environment } from './environments/environment';\r\n\r\nif (environment.production) {\r\n  enableProdMode();\r\n}\r\n\r\nplatformBrowserDynamic().bootstrapModule(AppModule)\r\n  .catch(err => console.error(err));\r\n","function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"zn8P\";"]}