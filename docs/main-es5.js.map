{"version":3,"sources":["webpack:///$_lazy_route_resources|lazy|groupOptions: {}|namespace object","webpack:///src/app/components/Player.js","webpack:///src/app/app-routing.module.ts","webpack:///src/app/app.component.ts","webpack:///src/app/app.module.ts","webpack:///src/app/components/controls/controls.component.ts","webpack:///src/app/components/instanced-object/instanced-object.component.ts","webpack:///src/app/components/stage/stage.component.ts","webpack:///src/app/data/controls.ts","webpack:///src/app/data/entities.ts","webpack:///src/app/services/camera-position.service.ts","webpack:///src/app/services/control-state.service.ts","webpack:///src/app/services/entity.service.ts","webpack:///src/app/services/sky.service.ts","webpack:///src/app/shader/instanced-shader.ts","webpack:///src/environments/environment.ts","webpack:///src/main.ts","webpack:///src/app/app.component.scss","webpack:///src/app/components/controls/controls.component.scss","webpack:///src/app/components/instanced-object/instanced-object.component.scss","webpack:///src/app/components/stage/stage.component.scss","webpack:///src/app/app.component.html","webpack:///src/app/components/controls/controls.component.html","webpack:///src/app/components/instanced-object/instanced-object.component.html","webpack:///src/app/components/stage/stage.component.html"],"names":["webpackEmptyAsyncContext","req","Promise","resolve","then","e","Error","code","keys","id","module","exports","startPosition","Vector3","endPosition","Player","maxSpeed","height","head","GameEntity","add","updateOrientation","navMesh","currentRegion","delta","copy","position","clampMovement","distance","distanceToPoint","y","MovingEntity","routes","AppRoutingModule","NgModule","imports","RouterModule","relativeLinkResolution","AppComponent","title","Component","selector","template","AppModule","declarations","StageComponent","InstancedObjectComponent","ControlsComponent","BrowserModule","providers","bootstrap","controlStateService","ev","preventDefault","controlState","mouseIsDown","mouseX","clientX","window","innerWidth","mouseY","clientY","innerHeight","touches","keyCode","forward","backwards","left","right","getControlState","ControlStateService","HostListener","changeDetection","ChangeDetectionStrategy","lights","vertexShader","fragmentShader","init","instanceBuffer","i","ul","instances","offsets","setXYZ","transforms","x","z","needsUpdate","length","loader","GLTFLoader","setPath","load","src","gltf","g1","scene","children","geometry","mergeGeometry","BufferGeometryUtils","mirror","rotateY","Math","PI","scale","loadedMaterial","material","Float32Array","setUsage","vector","setAttribute","orientations","count","setFromEuler","rotation","setXYZW","w","texture","map","ambientMap","attributes","uv2","anisotropy","renderer","capabilities","getMaxAnisotropy","uniforms","value","side","transparent","mesh","transform","set","frustumCulled","matrixAutoUpdate","updateMatrix","aoMap","flipY","aoMapIntensity","dummy","setMatrixAt","matrix","temp","faces","face","normal","vertexNormals","a","c","faceVertexUvs","verticesNeedUpdate","normalsNeedUpdate","vertexNormalsNeedUpdate","computeBoundingSphere","Input","entityService","skyService","cameraPositionService","deltaTime","createEntities","entities","getEntities","clock","entityManager","time","container","document","getElementById","camera","makeSky","setPixelRatio","devicePixelRatio","setSize","appendChild","domElement","stats","dom","player","loader2","epsilonCoplanarTest","setRenderComponent","sync","animate","console","log","aspect","updateProjectionMatrix","requestAnimationFrame","bind","render","update","getDelta","updateCamera","entity","renderComponent","EntityService","SkyService","CameraPositionService","CONTROLS","ENTITIES","direction","state","sin","cos","slowdown","Injectable","providedIn","n","posX","posZ","posY","k","push","light","target","hemilight","sky","Sky","setScalar","turbidity","rayleigh","mieCoefficient","mieDirectionalG","parameters","inclination","azimuth","theta","phi","sunPosition","environment","production","enableProdMode","platformBrowserDynamic","bootstrapModule","err","error"],"mappings":"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","file":"main-es5.js","sourcesContent":["function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = 8255;\nmodule.exports = webpackEmptyAsyncContext;","/**\n * @author Mugen87 / https://github.com/Mugen87\n */\n\nimport { MovingEntity, GameEntity, Vector3 } from 'yuka';\n\nconst startPosition = new Vector3();\nconst endPosition = new Vector3();\n\nclass Player extends MovingEntity {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.maxSpeed = 4;\n\t\tthis.height = 2;\n\n\t\tthis.head = new GameEntity();\n\t\tthis.add( this.head );\n\n\t\tthis.updateOrientation = false;\n\t\tthis.navMesh = null;\n\t\tthis.currentRegion = null;\n\n\t}\n\n\tupdate( delta ) {\n\n\t\tstartPosition.copy( this.position );\n\n\t\tsuper.update( delta );\n\n\t\tendPosition.copy( this.position );\n\n\t\t// ensure the entity stays inside its navmesh\n\n\t\tthis.currentRegion = this.navMesh.clampMovement(\n\t\t\tthis.currentRegion,\n\t\t\tstartPosition,\n\t\t\tendPosition,\n\t\t\tthis.position\n\t\t);\n\n\t\t// adjust height of player according to the ground\n\n\t\tconst distance = this.currentRegion.distanceToPoint( this.position );\n\n\t\tthis.position.y -= distance * 0.2; // smooth transition\n\n\t}\n\n}\n\n\nexport { Player };\n","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\n\r\nconst routes: Routes = [];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forRoot(routes, { relativeLinkResolution: 'legacy' })],\r\n  exports: [RouterModule]\r\n})\r\nexport class AppRoutingModule { }\r\n","import { Component } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-root',\r\n  templateUrl: './app.component.html',\r\n  styleUrls: ['./app.component.scss']\r\n})\r\nexport class AppComponent {\r\n  title = 'pergamon';\r\n}\r\n","import { BrowserModule } from '@angular/platform-browser';\r\nimport { NgModule } from '@angular/core';\r\n\r\nimport { AppRoutingModule } from './app-routing.module';\r\nimport { AppComponent } from './app.component';\r\nimport { StageComponent } from './components/stage/stage.component';\r\nimport { InstancedObjectComponent } from './components/instanced-object/instanced-object.component';\nimport { ControlsComponent } from './components/controls/controls.component';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    AppComponent,\r\n    StageComponent,\r\n    InstancedObjectComponent,\r\n    ControlsComponent\r\n  ],\r\n  imports: [\r\n    BrowserModule,\r\n    AppRoutingModule\r\n  ],\r\n  providers: [],\r\n  bootstrap: [AppComponent]\r\n})\r\nexport class AppModule { }\r\n","import { Component, OnInit, HostListener, ChangeDetectionStrategy } from '@angular/core';\nimport { ControlState } from 'src/app/models/control-state';\nimport { ControlStateService } from 'src/app/services/control-state.service';\n\n@Component({\n  selector: 'pgm-controls',\n  templateUrl: './controls.component.html',\n  styleUrls: ['./controls.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n\n})\nexport class ControlsComponent implements OnInit {\n  controlState: ControlState\n\n  @HostListener('document:mousedown', ['$event'])\n  onMouseDown(ev: MouseEvent) {\n    ev.preventDefault();\n    // this.controlState.forward = true;\n    this.controlState.mouseIsDown = true;\n    this.controlState.mouseX = (ev.clientX / window.innerWidth - .5) * 2;\n    this.controlState.mouseY = (ev.clientY / window.innerHeight - .5) * 2;\n    // console.log(this.controlState.mouseX);\n    // console.log(ev.clientX)\n  }\n\n  @HostListener('document:mousemove', ['$event'])\n  onMouseMove(ev: MouseEvent) {\n    ev.preventDefault();\n    this.controlState.mouseX = (ev.clientX / window.innerWidth - .5) * 2;\n    this.controlState.mouseY = (ev.clientY / window.innerHeight - .5) * 2;\n    // console.log(this.controlState.mouseX);\n  }\n\n  @HostListener('document:mouseup', ['$event'])\n  onMouseUp(ev: MouseEvent) {\n    ev.preventDefault();\n    this.controlState.mouseIsDown = false;\n  }\n\n  @HostListener('document:touchstart', ['$event'])\n  onPointerDown(ev: TouchEvent) {\n    // ev.preventDefault();\n    this.controlState.mouseIsDown = true;\n    this.controlState.mouseX = (ev.touches[0].clientX / window.innerWidth - .5) * 2;\n    this.controlState.mouseY = (ev.touches[0].clientY / window.innerHeight - .5) * 2;\n  }\n\n  @HostListener('document:touchmove', ['$event'])\n  onPointerMove(ev: TouchEvent) {\n    // ev.preventDefault();\n    // console.log(ev);\n    this.controlState.mouseX = (ev.touches[0].clientX / window.innerWidth - .5) * 2;\n    this.controlState.mouseY = (ev.touches[0].clientY / window.innerHeight - .5) * 2;\n    // console.log(this.controlState.mouseX);\n  }\n\n  @HostListener('document:touchend', ['$event'])\n  onTouchEnd(ev: TouchEvent) {\n    // ev.preventDefault();\n    this.controlState.mouseIsDown = false;\n  }\n\n  @HostListener('document:keydown', ['$event'])\n  onKeyDown(ev: KeyboardEvent) {\n    // console.log(`The user just pressed ${ev.key}!`);\n    switch (ev.keyCode) {\n      case 38: /*up*/\n      case 87: /*W*/\n        this.controlState.forward = true;\n        break;\n      case 40: /*down*/\n      case 83: /*S*/\n        this.controlState.backwards = true;\n        break;\n      case 37: /*left*/\n      case 65: /*A*/\n        this.controlState.left = true;\n        break;\n      case 39: /*right*/\n      case 68: /*D*/\n        this.controlState.right = true;\n        break;\n    }\n  }\n\n  @HostListener('document:keyup', ['$event'])\n  onKeyUp(ev: KeyboardEvent) {\n    // console.log(`The user just released ${ev.key}!`);\n    switch (ev.keyCode) {\n      case 38: /*up*/\n      case 87: /*W*/\n        this.controlState.forward = false;\n        break;\n      case 40: /*down*/\n      case 83: /*S*/\n        this.controlState.backwards = false;\n        break;\n      case 37: /*left*/\n      case 65: /*A*/\n        this.controlState.left = false;\n        break;\n      case 39: /*right*/\n      case 68: /*D*/\n        this.controlState.right = false;\n        break;\n    }\n  }\n\n\n  constructor(public controlStateService: ControlStateService) { }\n\n  ngOnInit(): void {\n    this.controlState = this.controlStateService.getControlState();\n  }\n\n}\n","import { Component, OnInit, Input, OnChanges, ChangeDetectionStrategy } from '@angular/core';\r\nimport * as THREE from 'three';\r\n\r\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader.js';\r\nimport { BufferGeometryUtils } from 'three/examples/jsm/utils/BufferGeometryUtils';\r\nimport { vertexShader, fragmentShader } from '../../shader/instanced-shader';\r\nimport { ObjectTransform } from 'src/app/models/object-transform';\r\n\r\n@Component({\r\n  selector: 'pgm-instanced-object',\r\n  templateUrl: './instanced-object.component.html',\r\n  styleUrls: ['./instanced-object.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n\r\n})\r\nexport class InstancedObjectComponent implements OnInit, OnChanges {\r\n  @Input() scene;\r\n  @Input() renderer;\r\n  @Input() changeStep;\r\n  instances;\r\n  @Input() src;\r\n  @Input() mirror;\r\n  @Input() transforms: ObjectTransform[];\r\n  @Input() transform: ObjectTransform;\r\n  @Input() lights = true;\r\n  orientations;\r\n  offsets;\r\n  // speeds;\r\n  instanceBuffer;\r\n  //instanceBufferSpeed;\r\n  vertexShader = vertexShader;\r\n  fragmentShader = fragmentShader;\r\n  constructor() {}\r\n\r\n  ngOnInit() {\r\n    this.init();\r\n  }\r\n\r\n  ngOnChanges() {\r\n    if (this.instanceBuffer) {\r\n      for (let i = 0, ul = this.instances; i < ul; i++) {\r\n        // move out at least 5 units from center in current direction\r\n        this.offsets.setXYZ(\r\n          i,\r\n          this.transforms[i].position.x,\r\n          this.transforms[i].position.y,\r\n          this.transforms[i].position.z,\r\n        );\r\n      }\r\n      this.instanceBuffer.needsUpdate = true;\r\n    }\r\n  }\r\n\r\n  init() {\r\n    this.instances = this.transforms.length;\r\n    const loader = new GLTFLoader().setPath('./assets/models/');\r\n    loader.load(this.src, (gltf: any) => {\r\n      // console.log(gltf.scene);\r\n      // const loadedGeometry = gltf.scene.children[0].geometry;\r\n\r\n      const g1 = gltf.scene.children[0].geometry;\r\n      // const matrix = new THREE.Matrix4();\r\n      let mergeGeometry = new THREE.BufferGeometry();\r\n      mergeGeometry = BufferGeometryUtils.mergeBufferGeometries([g1]);\r\n      if (this.mirror.x) {\r\n        g1.rotateY(Math.PI);\r\n        mergeGeometry = BufferGeometryUtils.mergeBufferGeometries([mergeGeometry, g1]);\r\n        // matrix.set(-1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);\r\n        g1.scale(-1, 1, 1);\r\n        // this.flipNormals(g1);\r\n        mergeGeometry = BufferGeometryUtils.mergeBufferGeometries([mergeGeometry, g1]);\r\n        g1.rotateY(Math.PI);\r\n        mergeGeometry = BufferGeometryUtils.mergeBufferGeometries([mergeGeometry, g1]);\r\n      }\r\n\r\n      const loadedMaterial = gltf.scene.children[0].material;\r\n\r\n      /* const loadedMaterial = new THREE.MeshBasicMaterial();\r\n      loadedMaterial.map = gltf.scene.children[0].material.map; */\r\n\r\n      if (!this.lights) {\r\n        const geometry = mergeGeometry;\r\n\r\n        // per instance data\r\n        this.instanceBuffer = new THREE.InstancedInterleavedBuffer(\r\n          new Float32Array(this.instances * 8),\r\n          8,\r\n          1,\r\n        ).setUsage(THREE.DynamicDrawUsage);\r\n        /* this.instanceBufferSpeed = new THREE.InstancedInterleavedBuffer(\r\n          new Float32Array(this.instances * 8),\r\n          8,\r\n          1,\r\n        ).setUsage(THREE.DynamicDrawUsage); */\r\n        this.offsets = new THREE.InterleavedBufferAttribute(this.instanceBuffer, 3, 0);\r\n        // this.speeds = new THREE.InterleavedBufferAttribute(this.instanceBufferSpeed, 3, 0);\r\n\r\n        const vector = new THREE.Quaternion();\r\n        for (let i = 0, ul = this.instances; i < ul; i++) {\r\n          const x = this.transforms[i].position.x;\r\n          const y = this.transforms[i].position.y;\r\n          const z = this.transforms[i].position.z;\r\n\r\n          // move out at least 5 units from center in current direction\r\n          this.offsets.setXYZ(i, x, y, z);\r\n\r\n          // this.speeds.setXYZ(i, x * 0.01, 0, z * 0.01);\r\n        }\r\n\r\n        geometry.setAttribute('offset', this.offsets); // per mesh translation\r\n\r\n        this.orientations = new THREE.InterleavedBufferAttribute(this.instanceBuffer, 4, 4);\r\n\r\n        for (let i = 0, ul = this.orientations.count; i < ul; i++) {\r\n          vector.setFromEuler(\r\n            new THREE.Euler(\r\n              this.transforms[i].rotation.x,\r\n              this.transforms[i].rotation.y,\r\n              this.transforms[i].rotation.z,\r\n            ),\r\n          );\r\n          // vector.normalize();\r\n          this.orientations.setXYZW(i, 0, vector.y, 0, 1);\r\n\r\n          this.orientations.setXYZW(i, vector.x, vector.y, vector.z, vector.w);\r\n          // this.orientations.setY( i, vector.y );\r\n        }\r\n\r\n        geometry.setAttribute('orientation', this.orientations); // per mesh orientation\r\n\r\n        // material\r\n        const texture = loadedMaterial.map;\r\n        let ambientMap;\r\n        if (gltf.scene.children[0].geometry.attributes.uv2) {\r\n          ambientMap = new THREE.TextureLoader().load('./assets/textures/stoa-floor-ao.jpg');\r\n        }\r\n\r\n        if (texture) {\r\n          texture.anisotropy = this.renderer.capabilities.getMaxAnisotropy();\r\n        }\r\n\r\n        const material = new THREE.RawShaderMaterial({\r\n          uniforms: {\r\n            map: { value: texture },\r\n            ambientMap,\r\n          },\r\n          vertexShader: this.vertexShader,\r\n          fragmentShader: this.fragmentShader,\r\n          side: THREE.FrontSide,\r\n          transparent: false,\r\n        });\r\n\r\n        const mesh = new THREE.Mesh(geometry, material);\r\n        if (this.transform && this.transform.rotation) {\r\n          mesh.rotation.set(\r\n            this.transform.rotation.x,\r\n            this.transform.rotation.y,\r\n            this.transform.rotation.z,\r\n          );\r\n        }\r\n        if (this.transform && this.transform.position) {\r\n          mesh.position.set(\r\n            this.transform.position.x,\r\n            this.transform.position.y,\r\n            this.transform.position.z,\r\n          );\r\n        }\r\n        mesh.frustumCulled = false;\r\n        mesh.matrixAutoUpdate = false;\r\n        mesh.updateMatrix();\r\n        this.scene.add(mesh);\r\n      } else {\r\n        var count = this.transforms.length;\r\n\r\n        if (gltf.scene.children[0].geometry.attributes.uv2) {\r\n          let aoMap = new THREE.TextureLoader().load(\r\n            'assets/textures/stoa-floor-ao.png',\r\n            (texture) => {\r\n              texture.needsUpdate = true;\r\n              texture.flipY = false;\r\n            },\r\n          );\r\n          loadedMaterial.aoMap = aoMap;\r\n          loadedMaterial.aoMapIntensity = 2;\r\n        }\r\n\r\n        var mesh = new THREE.InstancedMesh(mergeGeometry, loadedMaterial, count);\r\n\r\n        var dummy = new THREE.Object3D();\r\n\r\n        for (var i = 0; i < count; i++) {\r\n          dummy.position.set(\r\n            this.transforms[i].position.x,\r\n            this.transforms[i].position.y,\r\n            this.transforms[i].position.z,\r\n          );\r\n\r\n          dummy.rotation.set(\r\n            this.transforms[i].rotation.x,\r\n            this.transforms[i].rotation.y,\r\n            this.transforms[i].rotation.z,\r\n          );\r\n\r\n          dummy.updateMatrix();\r\n\r\n          mesh.setMatrixAt(i, dummy.matrix);\r\n        }\r\n      }\r\n      if (this.transform && this.transform.rotation) {\r\n        mesh.rotation.set(\r\n          this.transform.rotation.x,\r\n          this.transform.rotation.y,\r\n          this.transform.rotation.z,\r\n        );\r\n      }\r\n      if (this.transform && this.transform.position) {\r\n        mesh.position.set(\r\n          this.transform.position.x,\r\n          this.transform.position.y,\r\n          this.transform.position.z,\r\n        );\r\n      }\r\n      mesh.matrixAutoUpdate = false;\r\n\r\n      mesh.updateMatrix();\r\n      this.scene.add(mesh);\r\n    });\r\n  }\r\n\r\n  flipNormals(geometry) {\r\n    // console.log(geometry);\r\n    let temp = 0;\r\n    // let face;\r\n\r\n    // flip every vertex normal in geometry by multiplying normal by -1\r\n    for (let i = 0; i < geometry.faces.length; i++) {\r\n      const face = geometry.faces[i];\r\n      face.normal.x = -1 * face.normal.x;\r\n      face.normal.y = 1 * face.normal.y;\r\n      face.normal.z = 1 * face.normal.z;\r\n\r\n      face.vertexNormals[0].x = -1 * face.vertexNormals[0].x;\r\n      face.vertexNormals[0].y = 1 * face.vertexNormals[0].y;\r\n      face.vertexNormals[0].z = 1 * face.vertexNormals[0].z;\r\n\r\n      face.vertexNormals[1].x = -1 * face.vertexNormals[1].x;\r\n      face.vertexNormals[1].y = 1 * face.vertexNormals[1].y;\r\n      face.vertexNormals[1].z = 1 * face.vertexNormals[1].z;\r\n\r\n      face.vertexNormals[2].x = -1 * face.vertexNormals[2].x;\r\n      face.vertexNormals[2].y = 1 * face.vertexNormals[2].y;\r\n      face.vertexNormals[2].z = 1 * face.vertexNormals[2].z;\r\n\r\n      temp = face.vertexNormals[0];\r\n      face.vertexNormals[0] = face.vertexNormals[2];\r\n      face.vertexNormals[2] = temp;\r\n    }\r\n\r\n    /*     for (let i = 0; i < geometry.vertices.length; i++) {\r\n      const vertex = geometry.vertices[i];\r\n      vertex.normal.x = -1 * vertex.normal.x;\r\n      vertex.normal.y = -1 * vertex.normal.y;\r\n      vertex.normal.z = -1 * vertex.normal.z;\r\n    } */\r\n\r\n    // change face winding order\r\n    for (let i = 0; i < geometry.faces.length; i++) {\r\n      const face = geometry.faces[i];\r\n      temp = face.a;\r\n      face.a = face.c;\r\n      face.c = temp;\r\n    }\r\n\r\n    // flip UV coordinates\r\n\r\n    const faceVertexUvs = geometry.faceVertexUvs[0];\r\n    for (let i = 0; i < faceVertexUvs.length; i++) {\r\n      temp = faceVertexUvs[i][0];\r\n      faceVertexUvs[i][0] = faceVertexUvs[i][2];\r\n      faceVertexUvs[i][2] = temp;\r\n    }\r\n\r\n    geometry.verticesNeedUpdate = true;\r\n    geometry.normalsNeedUpdate = true;\r\n    geometry.vertexNormalsNeedUpdate = true;\r\n\r\n    /* geometry.computeFaceNormals();\r\n    geometry.computeVertexNormals(); */\r\n    geometry.computeBoundingSphere();\r\n  }\r\n}\r\n","import { ChangeDetectionStrategy, Component, OnInit, Player } from '@angular/core';\r\nimport * as THREE from 'three';\r\nimport * as YUKA from 'yuka';\r\nimport { Player } from '../Player.js';\r\n\r\nimport Stats from 'three/examples/jsm/libs/stats.module.js';\r\n\r\n// import { FirstPersonControls } from 'three/examples/jsm/controls/FirstPersonControls';\r\n// import { MapControls } from 'three/examples/jsm/controls/OrbitControls';\r\n// import { CannonPhysics } from 'three/examples/jsm/physics/CannonPhysics.js';\r\n\r\nimport { Entity } from 'src/app/models/entity';\r\nimport { EntityService } from 'src/app/services/entity.service';\r\nimport { SkyService } from 'src/app/services/sky.service';\r\nimport { CameraPositionService } from 'src/app/services/camera-position.service';\r\n\r\n@Component({\r\n  selector: 'pgm-stage',\r\n  templateUrl: './stage.component.html',\r\n  styleUrls: ['./stage.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n\r\n})\r\nexport class StageComponent implements OnInit {\r\n  container;\r\n  stats: Stats;\r\n\r\n  camera: THREE.PerspectiveCamera;\r\n  scene: THREE.Scene;\r\n  renderer: THREE.WebGLRenderer;\r\n  entities: Entity[];\r\n  deltaTime = 1;\r\n  entityManager: YUKA.EntityManager;\r\n  time: YUKA.time;\r\n  player: Player;\r\n\r\n  // controls;\r\n  clock: THREE.Clock;\r\n\r\n  constructor(\r\n    public entityService: EntityService,\r\n    public skyService: SkyService,\r\n    public cameraPositionService: CameraPositionService,\r\n  ) {}\r\n\r\n  ngOnInit() {\r\n    this.entityService.createEntities();\r\n    this.entities = this.entityService.getEntities();\r\n    this.init();\r\n  }\r\n\r\n  init() {\r\n    this.clock = new THREE.Clock();\r\n    this.entityManager = new YUKA.EntityManager();\r\n    this.time = new YUKA.Time();\r\n\r\n    this.container = document.getElementById('container');\r\n\r\n    this.camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 0.3, 500);\r\n    /*    this.camera.position.x = 5;\r\n       this.camera.position.y = 1.6;\r\n       this.camera.position.z = -5; */\r\n    this.camera.matrixAutoUpdate = false;\r\n    // this.camera.rotation.y = Math.PI;\r\n\r\n    this.scene = new THREE.Scene();\r\n\r\n    this.renderer = new THREE.WebGLRenderer();\r\n\r\n    /*  this.controls.enableDamping = true; // an animation loop is required when either damping or auto-rotation are enabled\r\n        this.controls.dampingFactor = 0.05;\r\n        this.controls.screenSpacePanning = false;\r\n        this.controls.minDistance = 5;\r\n        this.controls.maxDistance = 200;\r\n        this.controls.maxPolarAngle = Math.PI / 2.015;\r\n        this.controls.target.set(0, 0, 60);\r\n     */\r\n    \r\n    this.skyService.makeSky(this.scene);\r\n\r\n  /*   if (this.renderer.extensions.get('ANGLE_instanced_arrays') === null) {\r\n      //document.getElementById('notSupported').style.display = '';\r\n      return;\r\n    } */\r\n    this.renderer.setPixelRatio(window.devicePixelRatio);\r\n    this.renderer.setSize(window.innerWidth, window.innerHeight);\r\n    this.container.appendChild(this.renderer.domElement);\r\n    \r\n    this.stats = Stats();\r\n    this.container.appendChild(this.stats.dom);\r\n\r\n    /*     this.controls = new FirstPersonControls(this.camera, this.renderer.domElement);\r\n        this.controls.movementSpeed = 10;\r\n        this.controls.lookSpeed = 0.1;\r\n        this.controls.lookAt(0, 0, 0);\r\n    \r\n        this.controls.constrainVertical = true;\r\n        this.controls.verticalMax = Math.PI * .55;\r\n        this.controls.verticalMin = Math.PI * .35; */\r\n\r\n    this.player = new Player();\r\n    const loader2 = new YUKA.NavMeshLoader();\r\n    loader2.load('./assets/models/navmesh.glb', { epsilonCoplanarTest: 0.25 }).then((navMesh) => {\r\n      // visualize convex regions\r\n\r\n      // const navMeshGroup = createConvexRegionHelper( navMesh );\r\n      // scene.add( navMeshGroup );\r\n\r\n      this.player.navMesh = navMesh;\r\n      this.player.head.setRenderComponent(this.camera, this.sync);\r\n\r\n      this.player.position.set(5, 0, -5);\r\n      this.entityManager.add(this.player);\r\n\r\n      // const loadingScreen = document.getElementById( 'loading-screen' );\r\n\r\n      // loadingScreen.classList.add( 'fade-out' );\r\n      // loadingScreen.addEventListener( 'transitionend', onTransitionEnd );\r\n\r\n      // animate();\r\n    });\r\n    \r\n    this.animate();\r\n  }\r\n\r\n  onWindowResize() {\r\n    console.log('resize');\r\n    // this.controls.handleResize();\r\n    this.camera.aspect = window.innerWidth / window.innerHeight;\r\n    this.camera.updateProjectionMatrix();\r\n\r\n    this.renderer.setSize(window.innerWidth, window.innerHeight);\r\n  }\r\n\r\n  animate() {\r\n    requestAnimationFrame(this.animate.bind(this));\r\n    this.render();\r\n  }\r\n\r\n  render() {\r\n    this.stats.update();\r\n    // this.deltaTime = this.clock.getDelta();\r\n    const delta = this.time.update().getDelta();\r\n    this.cameraPositionService.updateCamera(this.player, delta * 30);\r\n\r\n    this.entityManager.update(delta);\r\n    this.camera.position.x = this.player.position.x;\r\n    this.camera.position.y = this.player.position.y + this.player.height;\r\n    this.camera.position.z = this.player.position.z;\r\n    this.camera.rotation.x = this.player.rotation.x;\r\n    this.camera.rotation.y = this.player.rotation.y;\r\n    this.camera.rotation.z = this.player.rotation.z;\r\n\r\n    // console.log(this.player.position.x);\r\n\r\n    // controls.update( delta );\r\n\r\n    this.camera.updateProjectionMatrix();\r\n    this.camera.updateMatrix();\r\n    this.renderer.render(this.scene, this.camera);\r\n  }\r\n\r\n  sync(entity, renderComponent) {\r\n    // renderComponent.matrixWorld.copy(entity.worldMatrix);\r\n  }\r\n}\r\n","import { ControlState } from '../models/control-state';\r\n\r\nexport let CONTROLS: ControlState = {\r\n    forward: false,\r\n    backwards: false,\r\n    left: false,\r\n    right: false,\r\n    mouseIsDown: false,\r\n    mouseX: 0,\r\n    mouseY: 0\r\n};","import { Entity } from '../models/entity';\r\n\r\nexport let ENTITIES: Entity[] = [\r\n  { src: 'capitol.glb', transforms: [], static: true, mirror: { x: true, y: true } },\r\n  {\r\n    src: 'corinthian-capital.glb',\r\n    transform: {\r\n      rotation: { x: 0, y: (Math.PI / 180) * -40.5, z: 0 },\r\n      position: { x: -18.7705, z: 52.6765, y: -5.02641 },\r\n    },\r\n    transforms: [],\r\n    static: true,\r\n    mirror: { x: false, y: false },\r\n  },\r\n  { src: 'pedistal.glb', transforms: [], static: true, mirror: { x: false, y: false } },\r\n  { src: 'shaft.glb', transforms: [], static: true, mirror: { x: false, y: false } },\r\n  {\r\n    src: 'column-court.glb',\r\n    transform: {\r\n      rotation: { x: 0, y: (Math.PI / 180) * -40.5, z: 0 },\r\n      position: { x: -18.7705, z: 52.6765, y: -5.02641 },\r\n    },\r\n    transforms: [],\r\n    static: true,\r\n    mirror: { x: false, y: false },\r\n  },\r\n  { src: 'chamber.glb', transforms: [], static: true, mirror: { x: false, y: false } },\r\n  { src: 'road.glb', transforms: [], static: true, mirror: { x: false, y: false } },\r\n  { src: 'stoa-floor.glb', transforms: [], static: true, mirror: { x: false, y: false } },\r\n  { src: 'stairs.glb', transforms: [], static: true, mirror: { x: false, y: false } },\r\n  { src: 'portal-pillar.glb', transforms: [], static: true, mirror: { x: false, y: false } },\r\n  { src: 'roof.glb', transforms: [], static: true, mirror: { x: false, y: false } },\r\n  { src: 'architrave.glb', transforms: [], static: true, mirror: { x: false, y: false } },\r\n  { src: 'hall-ceiling.glb', transforms: [], static: true, mirror: { x: false, y: false } },\r\n  {\r\n    src: 'propylon-walls.glb',\r\n    transforms: [\r\n      {\r\n        rotation: { x: 0, y: (Math.PI / 180) * -40.5, z: 0 },\r\n        position: { x: -18.7705, z: 52.6765, y: -5.02641 },\r\n      },\r\n    ],\r\n    static: true,\r\n    mirror: { x: false, y: false },\r\n  },\r\n  {\r\n    src: 'propylon-court-walls.glb',\r\n    transforms: [\r\n      {\r\n        rotation: { x: 0, y: (Math.PI / 180) * -40.5, z: 0 },\r\n        position: { x: -18.7705, z: 52.6765, y: -5.02641 },\r\n      },\r\n    ],\r\n    static: true,\r\n    mirror: { x: false, y: false },\r\n  },\r\n  {\r\n    src: 'propylon-court-floor.glb',\r\n    transforms: [\r\n      {\r\n        rotation: { x: 0, y: (Math.PI / 180) * -40.5, z: 0 },\r\n        position: { x: -18.7705, z: 52.6765, y: -5.02641 },\r\n      },\r\n    ],\r\n    static: true,\r\n    mirror: { x: false, y: false },\r\n  },\r\n  {\r\n    src: 'propylon-architrave.glb',\r\n    transforms: [\r\n      {\r\n        rotation: { x: 0, y: (Math.PI / 180) * -40.5, z: 0 },\r\n        position: { x: -18.7705, z: 52.6765, y: -5.02641 },\r\n      },\r\n    ],\r\n    static: true,\r\n    mirror: { x: false, y: false },\r\n  },\r\n  {\r\n    src: 'propylon-court-architrave.glb',\r\n    transforms: [\r\n      {\r\n        rotation: { x: 0, y: (Math.PI / 180) * -40.5, z: 0 },\r\n        position: { x: -18.7705, z: 52.6765, y: -5.02641 },\r\n      },\r\n    ],\r\n    static: true,\r\n    mirror: { x: false, y: false },\r\n  },\r\n  // { src: 'navmesh.glb', transforms: [], static: true, mirror: { x: false, y: false } },\r\n];\r\n","import { Injectable } from '@angular/core';\nimport * as THREE from 'three';\nimport { ControlStateService } from './control-state.service';\nimport { Vector3 } from 'yuka';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class CameraPositionService {\n  direction = new Vector3();\n\n  constructor(public controlStateService: ControlStateService) { }\n\n\n  public updateCamera(player: any, deltaTime: number) {\n    const state = this.controlStateService.getControlState();\n\n    //player.getDirection(this.direction);\n\n    //console.log(this.direction);\n    this.direction.x = Math.sin(player.rotation.y);\n    this.direction.z = Math.cos(player.rotation.y);\n    const slowdown = 5;\n\n    if (state.forward === true) {\n      player.position.z -= this.direction.z / slowdown * deltaTime;\n      player.position.x -= this.direction.x / slowdown * deltaTime;\n    }\n    if (state.backwards === true) {\n      player.position.z += this.direction.z / slowdown * deltaTime;\n      player.position.x += this.direction.x / slowdown * deltaTime;\n    }\n    if (state.right === true) {\n      player.rotation.y -= 6 * Math.PI / 360 * deltaTime;\n    }\n    if (state.left === true) {\n      player.rotation.y += 6 * Math.PI / 360 * deltaTime;\n    }\n\n    if (state.mouseIsDown === true) {\n      player.position.z -= this.direction.z / slowdown * deltaTime;\n      player.position.x -= this.direction.x / slowdown * deltaTime;\n      player.rotation.y += -state.mouseX * 3 * Math.PI / 360 * deltaTime;\n    }\n\n    /* if (player.position.x < 2) {\n      player.position.x = 2;\n    }\n    if (player.position.x > 8) {\n      player.position.x = 8;\n    } */\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { CONTROLS } from '../data/controls';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ControlStateService {\n\n  constructor() { }\n\n\n  public getControlState() {\n    return CONTROLS;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { ENTITIES } from '../data/entities';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class EntityService {\n  constructor() {}\n\n  public getEntities() {\n    return ENTITIES;\n  }\n\n  public createEntities() {\n    const entities = this.getEntities();\n    for (let n = 0; n < entities.length; n++) {\n      switch (entities[n].src) {\n        case 'capitol.glb':\n          for (let i = 0; i < 2; i++) {\n            const posX = i * 9.65;\n            const posZ = 2.645 * 4;\n            const posY = 4.35 + 0.225;\n            // const rotY = Math.random() * Math.PI;\n\n            for (let k = 0; k < 100; k++) {\n              entities[n].transforms.push({\n                rotation: { x: Math.PI, y: 0, z: 0 },\n\n                position: { x: posX, y: posY, z: posZ - k * 2.645 },\n              });\n            }\n            // move out at least 5 units from center in current direction\n          }\n          break;\n\n        case 'hall-ceiling.glb':\n          for (let i = 0; i < 2; i++) {\n            const posX = i * 9.65;\n            const posZ = 2.645 * 4;\n            const posY = 5.00371;\n            // const rotY = Math.random() * Math.PI;\n\n            for (let k = 0; k < 100; k++) {\n              entities[n].transforms.push({\n                rotation: { x: 0, y: i * Math.PI, z: 0 },\n\n                position: { x: posX, y: posY, z: posZ - k * (2.645 / 2) },\n              });\n            }\n            // move out at least 5 units from center in current direction\n          }\n          break;\n\n        case 'pedistal.glb':\n          for (let i = 0; i < 2; i++) {\n            const posX = i * 9.65;\n            const posZ = 2.645 * 4;\n            const posY = 0.5 + 0.225;\n            // const rotY = Math.random() * Math.PI;\n\n            for (let k = 0; k < 100; k++) {\n              entities[n].transforms.push({\n                rotation: { x: Math.PI, y: 0, z: 0 },\n\n                position: { x: posX, y: posY, z: posZ - k * 2.645 },\n              });\n            }\n            // move out at least 5 units from center in current direction\n          }\n          break;\n\n        case 'shaft.glb':\n          for (let i = 0; i < 2; i++) {\n            const posX = i * 9.65;\n            const posZ = 2.645 * 4;\n            const posY = 0.5 + 0.225;\n            // const rotY = Math.random() * Math.PI;\n\n            for (let k = 0; k < 100; k++) {\n              entities[n].transforms.push({\n                rotation: { x: 0, y: 0, z: 0 },\n\n                position: { x: posX, y: posY, z: posZ - k * 2.645 },\n              });\n            }\n            // move out at least 5 units from center in current direction\n          }\n          break;\n\n        case 'chamber.glb':\n          for (let i = 0; i < 1; i++) {\n            const posX = -5.2;\n            const posZ = 0;\n            const posY = 0 + 0.225;\n            // const rotY = Math.random() * Math.PI;\n\n            for (let k = 0; k < 20; k++) {\n              entities[n].transforms.push({\n                rotation: { x: 0, y: 0, z: 0 },\n\n                position: { x: posX, y: posY, z: posZ - 4.454 * k },\n              });\n            }\n\n            for (let k = 0; k < 18; k++) {\n              entities[n].transforms.push({\n                rotation: { x: 0, y: Math.PI, z: 0 },\n\n                position: { x: 15.2, y: posY, z: posZ - 4.454 * k },\n              });\n            }\n            // move out at least 5 units from center in current direction\n          }\n          break;\n\n        case 'portal-pillar.glb':\n          entities[n].transforms.push({\n            rotation: { x: 0, y: -Math.PI / 4, z: 0 },\n\n            position: { x: 2.582, y: -2.25, z: 15.6291 },\n          });\n\n          entities[n].transforms.push({\n            rotation: { x: 0, y: (Math.PI / 4) * 3, z: 0 },\n\n            position: { x: 5.6107, y: -2.25, z: 18.3544 },\n          });\n\n          // move out at least 5 units from center in current direction\n\n          break;\n\n        case 'column-court.glb':\n          const posZ = -36.6416;\n          const posY = 2.70996;\n          const distance = 34.0016 - 36.6416;\n          for (let i = 0; i < 2; i++) {\n            const posX = -11.4742 + i * 11.4742 * 2;\n            // const rotY = Math.random() * Math.PI;\n\n            for (let k = 0; k < 11; k++) {\n              entities[n].transforms.push({\n                rotation: { x: 0, y: 0, z: 0 },\n\n                position: { x: posX, y: posY, z: posZ - k * distance },\n              });\n            }\n            // move out at least 5 units from center in current direction\n          }\n          for (let k = 1; k < 9; k++) {\n            const distance = -11.4758 + 8.92584;\n            const posX = -11.4742 - k * distance;\n            const posZ = -36.6416;\n            entities[n].transforms.push({\n              rotation: { x: 0, y: 0, z: 0 },\n              position: { x: posX, y: posY, z: posZ },\n            });\n          }\n          break;\n\n        case 'corinthian-capital.glb':\n          for (let i = 0; i < 2; i++) {\n            const posZ = -36.6416;\n            const posY = 2.70996;\n            const distance = 34.0016 - 36.6416;\n            const posX = -11.4742 + i * 11.4742 * 2;\n            // const rotY = Math.random() * Math.PI;\n\n            for (let k = 0; k < 11; k++) {\n              entities[n].transforms.push({\n                rotation: { x: 0, y: 0, z: 0 },\n\n                position: { x: posX, y: posY, z: posZ - k * distance },\n              });\n            }\n            // move out at least 5 units from center in current direction\n          }\n          for (let k = 1; k < 9; k++) {\n            const distance = -11.4758 + 8.92584;\n            const posX = -11.4742 - k * distance;\n            const posY = 2.70996;\n            const posZ = -36.6416;\n            entities[n].transforms.push({\n              rotation: { x: 0, y: 0, z: 0 },\n              position: { x: posX, y: posY, z: posZ },\n            });\n          }\n          break;\n\n        default:\n          if (!entities[n].transforms || entities[n].transforms.length === 0) {\n            entities[n].transforms.push({\n              rotation: { x: 0, y: 0, z: 0 },\n\n              position: { x: 0, y: 0, z: 0 },\n            });\n          }\n\n          // move out at least 5 units from center in current direction\n\n          break;\n      }\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\r\nimport * as THREE from 'three';\r\nimport { Sky } from 'three/examples/jsm/objects/Sky';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class SkyService {\r\n\r\n  constructor() { }\r\n  public makeSky(scene) {\r\n    const light = new THREE.DirectionalLight(0xffffff, 0.8);\r\n    light.target.position.set(0, 0, 0);\r\n    const hemilight = new THREE.HemisphereLight(0xffffbb, 0x645f55, 0.8);\r\n    scene.add(hemilight);\r\n\r\n    scene.add(light);\r\n\r\n    const sky = new Sky();\r\n    sky.scale.setScalar(10000);\r\n    scene.add(sky);\r\n    const uniforms = sky.material.uniforms;\r\n    uniforms.turbidity.value = 10;\r\n    uniforms.rayleigh.value = 2;\r\n    //uniforms.luminance.value = 1;\r\n    uniforms.mieCoefficient.value = 0.005;\r\n    uniforms.mieDirectionalG.value = 0.8;\r\n    const parameters = {\r\n      distance: 400,\r\n      inclination: 0.15,\r\n      azimuth: 0.3\r\n    };\r\n\r\n    const theta = Math.PI * (parameters.inclination - 0.5);\r\n    const phi = 2 * Math.PI * (parameters.azimuth - 0.5);\r\n\r\n    light.position.x = parameters.distance * Math.cos(phi);\r\n    light.position.y = parameters.distance * Math.sin(phi) * Math.sin(theta);\r\n    light.position.z = parameters.distance * Math.sin(phi) * Math.cos(theta);\r\n    sky.material.uniforms.sunPosition.value = light.position.copy(\r\n      light.position\r\n    );\r\n    light.position.z = -parameters.distance * Math.sin(phi) * Math.cos(theta);\r\n\r\n  }\r\n}\r\n","export let vertexShader = `precision highp float;\r\n\r\n  uniform mat4 modelViewMatrix;\r\n  uniform mat4 projectionMatrix;\r\n\r\n  attribute vec3 position;\r\n  attribute vec3 offset;\r\n  attribute vec2 uv;\r\n  attribute vec4 orientation;\r\n\r\n  varying vec2 vUv;\r\n\r\n  // http://www.geeks3d.com/20141201/how-to-rotate-a-vertex-by-a-quaternion-in-glsl/\r\n\r\n  vec3 applyQuaternionToVector( vec4 q, vec3 v ){\r\n\r\n    return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );\r\n\r\n  }\r\n\r\n  void main() {\r\n\r\n    vec3 vPosition = applyQuaternionToVector( orientation, position );\r\n\r\n    vUv = uv;\r\n\r\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( offset + vPosition, 1.0 );\r\n\r\n  }`;\r\n\r\nexport let fragmentShader = `precision highp float;\r\n\r\n  uniform sampler2D map;\r\n\r\n  varying vec2 vUv;\r\n\r\n  void main() {\r\n\r\n    gl_FragColor = texture2D(map, vUv);\r\n\r\n  }`;\r\n","// This file can be replaced during build by using the `fileReplacements` array.\r\n// `ng build --prod` replaces `environment.ts` with `environment.prod.ts`.\r\n// The list of file replacements can be found in `angular.json`.\r\n\r\nexport const environment = {\r\n  production: false\r\n};\r\n\r\n/*\r\n * For easier debugging in development mode, you can import the following file\r\n * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.\r\n *\r\n * This import should be commented out in production mode because it will have a negative impact\r\n * on performance if an error is thrown.\r\n */\r\n// import 'zone.js/plugins/zone-error';  // Included with Angular CLI.\r\n","import { enableProdMode } from '@angular/core';\r\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\r\n\r\nimport { AppModule } from './app/app.module';\r\nimport { environment } from './environments/environment';\r\n\r\nif (environment.production) {\r\n  enableProdMode();\r\n}\r\n\r\nplatformBrowserDynamic().bootstrapModule(AppModule)\r\n  .catch(err => console.error(err));\r\n","export default \":host {\\n  display: block;\\n  width: 100%;\\n  height: 100%;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLGNBQUE7RUFDQSxXQUFBO0VBQ0EsWUFBQTtBQUNKIiwiZmlsZSI6ImFwcC5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIjpob3N0IHtcclxuICAgIGRpc3BsYXk6IGJsb2NrO1xyXG4gICAgd2lkdGg6MTAwJTtcclxuICAgIGhlaWdodDoxMDAlO1xyXG59Il19 */\";","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJjb250cm9scy5jb21wb25lbnQuc2NzcyJ9 */\";","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJpbnN0YW5jZWQtb2JqZWN0LmNvbXBvbmVudC5zY3NzIn0= */\";","export default \":host {\\n  display: block;\\n  width: 100%;\\n  height: 100%;\\n  -webkit-user-select: none;\\n     -moz-user-select: none;\\n          user-select: none;\\n}\\n\\na {\\n  color: #08f;\\n}\\n\\n#notSupported {\\n  width: 50%;\\n  margin: auto;\\n  background-color: #f00;\\n  margin-top: 20px;\\n  padding: 10px;\\n}\\n\\n.container {\\n  width: 100%;\\n  height: 100%;\\n  -webkit-user-select: none;\\n     -moz-user-select: none;\\n          user-select: none;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInN0YWdlLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsY0FBQTtFQUNBLFdBQUE7RUFDQSxZQUFBO0VBQ0EseUJBQUE7S0FBQSxzQkFBQTtVQUFBLGlCQUFBO0FBQ0Y7O0FBQ0E7RUFDRSxXQUFBO0FBRUY7O0FBQUE7RUFDRSxVQUFBO0VBQ0EsWUFBQTtFQUNBLHNCQUFBO0VBQ0EsZ0JBQUE7RUFDQSxhQUFBO0FBR0Y7O0FBQUE7RUFDRSxXQUFBO0VBQ0EsWUFBQTtFQUNBLHlCQUFBO0tBQUEsc0JBQUE7VUFBQSxpQkFBQTtBQUdGIiwiZmlsZSI6InN0YWdlLmNvbXBvbmVudC5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiOmhvc3Qge1xyXG4gIGRpc3BsYXk6IGJsb2NrO1xyXG4gIHdpZHRoOjEwMCU7XHJcbiAgaGVpZ2h0OjEwMCU7XHJcbiAgdXNlci1zZWxlY3Q6IG5vbmU7XHJcbn1cclxuYSB7XHJcbiAgY29sb3I6ICMwOGY7XHJcbn1cclxuI25vdFN1cHBvcnRlZCB7XHJcbiAgd2lkdGg6IDUwJTtcclxuICBtYXJnaW46IGF1dG87XHJcbiAgYmFja2dyb3VuZC1jb2xvcjogI2YwMDtcclxuICBtYXJnaW4tdG9wOiAyMHB4O1xyXG4gIHBhZGRpbmc6IDEwcHg7XHJcbn1cclxuXHJcbi5jb250YWluZXIge1xyXG4gIHdpZHRoOjEwMCU7XHJcbiAgaGVpZ2h0OiAxMDAlO1xyXG4gIHVzZXItc2VsZWN0OiBub25lO1xyXG59XHJcbiJdfQ== */\";","export default \"<pgm-stage></pgm-stage>\\r\\n\";","export default \"\\n\";","export default \"\";","export default \"<div id=\\\"container\\\" (window:resize)=\\\"onWindowResize();\\\" draggable=\\\"false\\\"></div>\\r\\n<pgm-controls draggable=\\\"false\\\"></pgm-controls>\\r\\n<!-- <div  draggable=\\\"false\\\" style=\\\"position: absolute; top: 20px; right: 20px;\\\">{{camera.position.x}}</div> -->\\r\\n\\r\\n<pgm-instanced-object *ngFor=\\\"let entity of entities\\\" [scene]=\\\"scene\\\" [renderer]=\\\"renderer\\\" [src]=\\\"entity.src\\\" [transform]=\\\"entity.transform\\\"\\r\\n  [transforms]=\\\"entity.transforms\\\" [mirror]=\\\"entity.mirror\\\">\\r\\n</pgm-instanced-object>\";"]}